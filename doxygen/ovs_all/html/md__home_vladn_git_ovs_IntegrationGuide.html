<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>ovs all: Integration Guide for Centralized Control</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">ovs all
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('md__home_vladn_git_ovs_IntegrationGuide.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Integration Guide for Centralized Control </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This document describes how to integrate Open vSwitch onto a new platform to expose the state of the switch and attached devices for centralized control. (If you are looking to port the switching components of Open vSwitch to a new platform, please see the PORTING document.) The focus of this guide is on hypervisors, but many of the interfaces are useful for hardware switches, as well. The XenServer integration is the most mature implementation, so most of the examples are drawn from it.</p>
<p>The externally visible interface to this integration is platform-agnostic. We encourage anyone who integrates Open vSwitch to use the same interface, because keeping a uniform interface means that controllers require less customization for individual platforms (and perhaps no customization at all).</p>
<p>Integration centers around the Open vSwitch database and mostly involves the 'external_ids' columns in several of the tables. These columns are not interpreted by Open vSwitch itself. Instead, they provide information to a controller that permits it to associate a database record with a more meaningful entity. In contrast, the 'other_config' column is used to configure behavior of the switch. The main job of the integrator, then, is to ensure that these values are correctly populated and maintained.</p>
<p>An integrator sets the columns in the database by talking to the ovsdb-server daemon. A few of the columns can be set during startup by calling the ovs-ctl tool from inside the startup scripts. The 'xenserver/etc_init.d_openvswitch' script provides examples of its use, and the ovs-ctl(8) manpage contains complete documentation. At runtime, ovs-vsctl can be be used to set columns in the database. The script 'xenserver/etc_xensource_scripts_vif' contains examples of its use, and ovs-vsctl(8) manpage contains complete documentation.</p>
<p>Python and C bindings to the database are provided if deeper integration with a program are needed. The XenServer ovs-xapi-sync daemon ('xenserver/usr_share_openvswitch_scripts_ovs-xapi-sync') provides an example of using the Python bindings. More information on the python bindings is available at '<a class="el" href="idl_8py.html">python/ovs/db/idl.py</a>'. Information on the C bindings is available at '<a class="el" href="ovsdb-idl_8h.html">lib/ovsdb-idl.h</a>'.</p>
<p>The following diagram shows how integration scripts fit into the Open vSwitch architecture: </p><pre class="fragment">            +----------------------------------------+
            |           Controller Cluster           +
            +----------------------------------------+
                                |
                                |
   +----------------------------------------------------------+
   |                            |                             |
   |             +--------------+---------------+             |
   |             |                              |             |
   |   +-------------------+           +------------------+   |
   |   |   ovsdb-server    |-----------|   ovs-vswitchd   |   |
   |   +-------------------+           +------------------+   |
   |             |                              |             |
   |  +---------------------+                   |             |
   |  | Integration scripts |                   |             |
   |  | (ex: ovs-xapi-sync) |                   |             |
   |  +---------------------+                   |             |
   |                                            |   Userspace |
   |----------------------------------------------------------|
   |                                            |      Kernel |
   |                                            |             |
   |                                 +---------------------+  |
   |                                 |  OVS Kernel Module  |  |
   |                                 +---------------------+  |
   +----------------------------------------------------------+
</pre><p>A description of the most relevant fields for integration follows. By setting these values, controllers are able to understand the network and manage it more dynamically and precisely. For more details about the database and each individual column, please refer to the ovs-vswitchd.conf.db(5) manpage.</p>
<h2>Open_vSwitch table </h2>
<p>The Open_vSwitch table describes the switch as a whole. The 'system_type' and 'system_version' columns identify the platform to the controller. The 'external_ids:system-id' key uniquely identifies the physical host. In XenServer, the system-id will likely be the same as the UUID returned by 'xe host-list'. This key allows controllers to distinguish between multiple hypervisors.</p>
<p>Most of this configuration can be done with the ovs-ctl command at startup. For example: </p><pre class="fragment">ovs-ctl --system-type="XenServer" --system-version="6.0.0-50762p" \
        --system-id="${UUID}" "${other_options}" start
</pre><p>Alternatively, the ovs-vsctl command may be used to set a particular value at runtime. For example: </p><pre class="fragment">ovs-vsctl set open_vswitch . external-ids:system-id='"${UUID}"'
</pre><p>The 'other_config:enable-statistics' key may be set to "true" to have OVS populate the database with statistics (e.g., number of CPUs, memory, system load) for the controller's use.</p>
<h2>Bridge table </h2>
<p>The Bridge table describes individual bridges within an Open vSwitch instance. The 'external-ids:bridge-id' key uniquely identifies a particular bridge. In XenServer, this will likely be the same as the UUID returned by 'xe network-list' for that particular bridge.</p>
<p>For example, to set the identifier for bridge "br0", the following command can be used: </p><pre class="fragment">ovs-vsctl set Bridge br0 external-ids:bridge-id='"${UUID}"'
</pre><p>The MAC address of the bridge may be manually configured by setting it with the "other_config:hwaddr" key. For example: </p><pre class="fragment">ovs-vsctl set Bridge br0 other_config:hwaddr="12:34:56:78:90:ab"
</pre><h2>Interface table </h2>
<p>The Interface table describes an interface under the control of Open vSwitch. The 'external_ids' column contains keys that are used to provide additional information about the interface: </p><pre class="fragment">attached-mac

    This field contains the MAC address of the device attached to
    the interface.  On a hypervisor, this is the MAC address of the
    interface as seen inside a VM.  It does not necessarily
    correlate to the host-side MAC address.  For example, on
    XenServer, the MAC address on a VIF in the hypervisor is always
    FE:FF:FF:FF:FF:FF, but inside the VM a normal MAC address is
    seen.

iface-id

    This field uniquely identifies the interface.  In hypervisors,
    this allows the controller to follow VM network interfaces as
    VMs migrate.  A well-chosen identifier should also allow an
    administrator or a controller to associate the interface with
    the corresponding object in the VM management system.  For
    example, the Open vSwitch integration with XenServer by default
    uses the XenServer assigned UUID for a VIF record as the
    iface-id.

iface-status

    In a hypervisor, there are situations where there are multiple
    interface choices for a single virtual ethernet interface inside
    a VM.  Valid values are "active" and "inactive".  A complete
    description is available in the ovs-vswitchd.conf.db(5) manpage.

vm-id

    This field uniquely identifies the VM to which this interface
    belongs.  A single VM may have multiple interfaces attached to
    it.
</pre><p>As in the previous tables, the ovs-vsctl command may be used to configure the values. For example, to set the 'iface-id' on eth0, the following command can be used: </p><pre class="fragment">ovs-vsctl set Interface eth0 external-ids:iface-id='"${UUID}"'</pre> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Wed Sep 9 2015 19:08:08 for ovs all by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.9.1 </li>
  </ul>
</div>
</body>
</html>
