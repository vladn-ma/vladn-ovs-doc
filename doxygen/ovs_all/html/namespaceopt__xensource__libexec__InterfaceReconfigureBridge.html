<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>ovs all: opt_xensource_libexec_InterfaceReconfigureBridge Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">ovs all
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="namespaces.html"><span>Namespace&#160;List</span></a></li>
      <li><a href="namespacemembers.html"><span>Namespace&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('namespaceopt__xensource__libexec__InterfaceReconfigureBridge.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">opt_xensource_libexec_InterfaceReconfigureBridge Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classopt__xensource__libexec__InterfaceReconfigureBridge_1_1DatapathBridge.html">DatapathBridge</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a20308e0c4784fcfcc26e0e371513e031"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceopt__xensource__libexec__InterfaceReconfigureBridge.html#a20308e0c4784fcfcc26e0e371513e031">open_pif_ifcfg</a> (pif)</td></tr>
<tr class="separator:a20308e0c4784fcfcc26e0e371513e031"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35cfa1d2aaf3486d6da02a2b07531ad9"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceopt__xensource__libexec__InterfaceReconfigureBridge.html#a35cfa1d2aaf3486d6da02a2b07531ad9">netdev_down</a> (<a class="el" href="structnetdev.html">netdev</a>)</td></tr>
<tr class="separator:a35cfa1d2aaf3486d6da02a2b07531ad9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20d9da72648ea002dae3fec160fed26b"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceopt__xensource__libexec__InterfaceReconfigureBridge.html#a20d9da72648ea002dae3fec160fed26b">netdev_up</a></td></tr>
<tr class="separator:a20d9da72648ea002dae3fec160fed26b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa40116fa5a648076e3f4d415f69157b0"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceopt__xensource__libexec__InterfaceReconfigureBridge.html#aa40116fa5a648076e3f4d415f69157b0">load_bonding_driver</a> ()</td></tr>
<tr class="separator:aa40116fa5a648076e3f4d415f69157b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2836104c031944b6459b1779aa4d99ca"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceopt__xensource__libexec__InterfaceReconfigureBridge.html#a2836104c031944b6459b1779aa4d99ca">bonding_driver_loaded</a> ()</td></tr>
<tr class="separator:a2836104c031944b6459b1779aa4d99ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1cde7065f28931b4c73777145441a789"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceopt__xensource__libexec__InterfaceReconfigureBridge.html#a1cde7065f28931b4c73777145441a789">bond_device_exists</a> (name)</td></tr>
<tr class="separator:a1cde7065f28931b4c73777145441a789"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57c78c2bb9fbbb613146c3b21914a081"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceopt__xensource__libexec__InterfaceReconfigureBridge.html#a57c78c2bb9fbbb613146c3b21914a081">create_bond_device</a> (pif)</td></tr>
<tr class="separator:a57c78c2bb9fbbb613146c3b21914a081"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc46b9667e82036ac572e846ddfcd6e2"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceopt__xensource__libexec__InterfaceReconfigureBridge.html#afc46b9667e82036ac572e846ddfcd6e2">destroy_bond_device</a> (pif)</td></tr>
<tr class="separator:afc46b9667e82036ac572e846ddfcd6e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91bdf695e53b05f0c091c7b16c79a114"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceopt__xensource__libexec__InterfaceReconfigureBridge.html#a91bdf695e53b05f0c091c7b16c79a114">bring_down_interface</a></td></tr>
<tr class="separator:a91bdf695e53b05f0c091c7b16c79a114"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad22a20a5fe3d312f7c6c1cdaa33fb2c5"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceopt__xensource__libexec__InterfaceReconfigureBridge.html#ad22a20a5fe3d312f7c6c1cdaa33fb2c5">interface_is_up</a> (pif)</td></tr>
<tr class="separator:ad22a20a5fe3d312f7c6c1cdaa33fb2c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99adb97cf5abbc2f156664aad1e6467e"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceopt__xensource__libexec__InterfaceReconfigureBridge.html#a99adb97cf5abbc2f156664aad1e6467e">bring_up_interface</a> (pif)</td></tr>
<tr class="separator:a99adb97cf5abbc2f156664aad1e6467e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8df3872bccb702ac68f81c828d328f28"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceopt__xensource__libexec__InterfaceReconfigureBridge.html#a8df3872bccb702ac68f81c828d328f28">pif_get_bond_slaves_sorted</a> (pif)</td></tr>
<tr class="separator:a8df3872bccb702ac68f81c828d328f28"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a4d32cb6285c1b0feb36a4059142ff237"><td class="memItemLeft" align="right" valign="top">tuple&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceopt__xensource__libexec__InterfaceReconfigureBridge.html#a4d32cb6285c1b0feb36a4059142ff237">sysfs_bonding_masters</a> = root_prefix()</td></tr>
<tr class="separator:a4d32cb6285c1b0feb36a4059142ff237"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a1cde7065f28931b4c73777145441a789"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def opt_xensource_libexec_InterfaceReconfigureBridge.bond_device_exists </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="keyword">def </span><a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigureBridge.html#a1cde7065f28931b4c73777145441a789">bond_device_exists</a>(name):</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    f = open(sysfs_bonding_masters, <span class="stringliteral">&quot;</span><span class="stringliteral">r&quot;)</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="stringliteral">    bonds = f.readline().split()</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="stringliteral">    f.close()</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="stringliteral">    </span><span class="keywordflow">return</span> name <span class="keywordflow">in</span> bonds</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div>
<div class="ttc" id="namespaceopt__xensource__libexec__InterfaceReconfigureBridge_html_a1cde7065f28931b4c73777145441a789"><div class="ttname"><a href="namespaceopt__xensource__libexec__InterfaceReconfigureBridge.html#a1cde7065f28931b4c73777145441a789">opt_xensource_libexec_InterfaceReconfigureBridge.bond_device_exists</a></div><div class="ttdeci">def bond_device_exists(name)</div><div class="ttdef"><b>Definition:</b> opt_xensource_libexec_InterfaceReconfigureBridge.py:76</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2836104c031944b6459b1779aa4d99ca"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def opt_xensource_libexec_InterfaceReconfigureBridge.bonding_driver_loaded </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="keyword">def </span><a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigureBridge.html#a2836104c031944b6459b1779aa4d99ca">bonding_driver_loaded</a>():</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    lines = open(<a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#ab95a81c16d03fa644cfce0f9bb204a2e">root_prefix</a>() + <span class="stringliteral">&quot;/proc/modules&quot;</span>).read().split(<span class="stringliteral">&quot;\n&quot;</span>)</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    modules = [line.split(<span class="stringliteral">&quot; &quot;</span>)[0] <span class="keywordflow">for</span> line <span class="keywordflow">in</span> lines]</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="keywordflow">return</span> <span class="stringliteral">&quot;bonding&quot;</span> <span class="keywordflow">in</span> modules</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div>
<div class="ttc" id="namespaceopt__xensource__libexec__InterfaceReconfigure_html_ab95a81c16d03fa644cfce0f9bb204a2e"><div class="ttname"><a href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#ab95a81c16d03fa644cfce0f9bb204a2e">opt_xensource_libexec_InterfaceReconfigure.root_prefix</a></div><div class="ttdeci">def root_prefix()</div><div class="ttdef"><b>Definition:</b> opt_xensource_libexec_InterfaceReconfigure.py:21</div></div>
<div class="ttc" id="namespaceopt__xensource__libexec__InterfaceReconfigureBridge_html_a2836104c031944b6459b1779aa4d99ca"><div class="ttname"><a href="namespaceopt__xensource__libexec__InterfaceReconfigureBridge.html#a2836104c031944b6459b1779aa4d99ca">opt_xensource_libexec_InterfaceReconfigureBridge.bonding_driver_loaded</a></div><div class="ttdeci">def bonding_driver_loaded()</div><div class="ttdef"><b>Definition:</b> opt_xensource_libexec_InterfaceReconfigureBridge.py:71</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a91bdf695e53b05f0c091c7b16c79a114"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def opt_xensource_libexec_InterfaceReconfigureBridge.bring_down_interface </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>pif</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>destroy</em> = <code>False</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Bring down the interface associated with PIF.

Brings down the given interface as well as any physical interfaces
which are bond slaves of this one. This is because they will be
required when the bond is brought up.</pre> <div class="fragment"><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="keyword">def </span><a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigureBridge.html#a91bdf695e53b05f0c091c7b16c79a114">bring_down_interface</a>(pif, destroy=False):</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;Bring down the interface associated with PIF.</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="stringliteral">    Brings down the given interface as well as any physical interfaces</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="stringliteral">    which are bond slaves of this one. This is because they will be</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="stringliteral">    required when the bond is brought up.&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keyword">def </span>destroy_bridge(pif):</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;Bring down the bridge associated with a PIF.&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <span class="comment">#if not pif_is_bridged(pif):</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="comment">#    return</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        bridge = <a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#aaa3ce147731f3202a1b6b338e0b9ac88">pif_bridge_name</a>(pif)</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <span class="keywordflow">if</span> <span class="keywordflow">not</span> <a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#ad78039d52f55017a0486e80317c6111b">netdev_exists</a>(bridge):</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            <a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#abd46881765b66c3cfdc50fc9bcd27fb4">log</a>(<span class="stringliteral">&quot;destroy_bridge: bridge %s does not exist, ignoring&quot;</span> % bridge)</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;            <span class="keywordflow">return</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#abd46881765b66c3cfdc50fc9bcd27fb4">log</a>(<span class="stringliteral">&quot;Destroy bridge %s&quot;</span> % bridge)</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigureBridge.html#a35cfa1d2aaf3486d6da02a2b07531ad9">netdev_down</a>(bridge)</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#a5a4219b402db35afa8566083452ffbf3">run_command</a>([<span class="stringliteral">&quot;/usr/sbin/brctl&quot;</span>, <span class="stringliteral">&quot;delbr&quot;</span>, bridge])</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keyword">def </span>destroy_vlan(pif):</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        vlan = <a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#a4da29bd56ee69cab3f0217101f0ca090">pif_netdev_name</a>(pif)</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <span class="keywordflow">if</span> <span class="keywordflow">not</span> <a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#ad78039d52f55017a0486e80317c6111b">netdev_exists</a>(vlan):</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            <a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#abd46881765b66c3cfdc50fc9bcd27fb4">log</a>(<span class="stringliteral">&quot;vconfig del: vlan %s does not exist, ignoring&quot;</span> % vlan)</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            <span class="keywordflow">return</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#abd46881765b66c3cfdc50fc9bcd27fb4">log</a>(<span class="stringliteral">&quot;Destroy vlan device %s&quot;</span> % vlan)</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#a5a4219b402db35afa8566083452ffbf3">run_command</a>([<span class="stringliteral">&quot;/sbin/vconfig&quot;</span>, <span class="stringliteral">&quot;rem&quot;</span>, vlan])</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="keywordflow">if</span> <a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#a656bc8221a4bf78465b68df92ff4f99b">pif_is_vlan</a>(pif):</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        interface = <a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#a4da29bd56ee69cab3f0217101f0ca090">pif_netdev_name</a>(pif)</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        <a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#abd46881765b66c3cfdc50fc9bcd27fb4">log</a>(<span class="stringliteral">&quot;bring_down_interface: %s is a VLAN&quot;</span> % interface)</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        <a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigureBridge.html#a35cfa1d2aaf3486d6da02a2b07531ad9">netdev_down</a>(interface)</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="keywordflow">if</span> destroy:</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            destroy_vlan(pif)</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            destroy_bridge(pif)</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <span class="keywordflow">else</span>:</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            <span class="keywordflow">return</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        slave = <a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#a8580f7ecd965581201083a07509c80dd">pif_get_vlan_slave</a>(pif)</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        <span class="keywordflow">if</span> <a class="code" href="structdb.html">db</a>().get_pif_record(slave)[<span class="stringliteral">&#39;currently_attached&#39;</span>]:</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            <a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#abd46881765b66c3cfdc50fc9bcd27fb4">log</a>(<span class="stringliteral">&quot;bring_down_interface: vlan slave is currently attached&quot;</span>)</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            <span class="keywordflow">return</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        masters = <a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#a81e1358bb7be902a70a1c49a56aace63">pif_get_vlan_masters</a>(slave)</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        masters = [m <span class="keywordflow">for</span> m <span class="keywordflow">in</span> masters <span class="keywordflow">if</span> m != pif <span class="keywordflow">and</span> <a class="code" href="structdb.html">db</a>().get_pif_record(m)[<span class="stringliteral">&#39;currently_attached&#39;</span>]]</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        <span class="keywordflow">if</span> len(masters) &gt; 0:</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            <a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#abd46881765b66c3cfdc50fc9bcd27fb4">log</a>(<span class="stringliteral">&quot;bring_down_interface: vlan slave has other masters&quot;</span>)</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            <span class="keywordflow">return</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        <a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#abd46881765b66c3cfdc50fc9bcd27fb4">log</a>(<span class="stringliteral">&quot;bring_down_interface: no more masters, bring down vlan slave %s&quot;</span> % <a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#a4da29bd56ee69cab3f0217101f0ca090">pif_netdev_name</a>(slave))</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        pif = slave</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keywordflow">else</span>:</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        vlan_masters = <a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#a81e1358bb7be902a70a1c49a56aace63">pif_get_vlan_masters</a>(pif)</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        <a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#abd46881765b66c3cfdc50fc9bcd27fb4">log</a>(<span class="stringliteral">&quot;vlan masters of %s - %s&quot;</span> % (<a class="code" href="structdb.html">db</a>().get_pif_record(pif)[<span class="stringliteral">&#39;device&#39;</span>], [<a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#a4da29bd56ee69cab3f0217101f0ca090">pif_netdev_name</a>(m) <span class="keywordflow">for</span> m <span class="keywordflow">in</span> vlan_masters]))</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <span class="keywordflow">if</span> len([m <span class="keywordflow">for</span> m <span class="keywordflow">in</span> vlan_masters <span class="keywordflow">if</span> <a class="code" href="structdb.html">db</a>().get_pif_record(m)[<span class="stringliteral">&#39;currently_attached&#39;</span>]]) &gt; 0:</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            <a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#abd46881765b66c3cfdc50fc9bcd27fb4">log</a>(<span class="stringliteral">&quot;Leaving %s up due to currently attached VLAN masters&quot;</span> % <a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#a4da29bd56ee69cab3f0217101f0ca090">pif_netdev_name</a>(pif))</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            <span class="keywordflow">return</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="comment"># pif is now either a bond or a physical device which needs to be brought down</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="comment"># Need to bring down bond slaves first since the bond device</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="comment"># must be up to enslave/unenslave.</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    bond_slaves = <a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigureBridge.html#a8df3872bccb702ac68f81c828d328f28">pif_get_bond_slaves_sorted</a>(pif)</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#abd46881765b66c3cfdc50fc9bcd27fb4">log</a>(<span class="stringliteral">&quot;bond slaves of %s - %s&quot;</span> % (<a class="code" href="structdb.html">db</a>().get_pif_record(pif)[<span class="stringliteral">&#39;device&#39;</span>], [<a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#a4da29bd56ee69cab3f0217101f0ca090">pif_netdev_name</a>(s) <span class="keywordflow">for</span> s <span class="keywordflow">in</span> bond_slaves]))</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="keywordflow">for</span> slave <span class="keywordflow">in</span> bond_slaves:</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        slave_interface = <a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#a4da29bd56ee69cab3f0217101f0ca090">pif_netdev_name</a>(slave)</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        <span class="keywordflow">if</span> <a class="code" href="structdb.html">db</a>().get_pif_record(slave)[<span class="stringliteral">&#39;currently_attached&#39;</span>]:</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;            <a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#abd46881765b66c3cfdc50fc9bcd27fb4">log</a>(<span class="stringliteral">&quot;leave bond slave %s up (currently attached)&quot;</span> % slave_interface)</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;            <span class="keywordflow">continue</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        <a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#abd46881765b66c3cfdc50fc9bcd27fb4">log</a>(<span class="stringliteral">&quot;bring down bond slave %s&quot;</span> % slave_interface)</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        <a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigureBridge.html#a35cfa1d2aaf3486d6da02a2b07531ad9">netdev_down</a>(slave_interface)</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        <span class="comment"># Also destroy the bridge associated with the slave, since</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <span class="comment"># it will carry the MAC address and possibly an IP address</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <span class="comment"># leading to confusion.</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        destroy_bridge(slave)</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    interface = <a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#a4da29bd56ee69cab3f0217101f0ca090">pif_netdev_name</a>(pif)</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#abd46881765b66c3cfdc50fc9bcd27fb4">log</a>(<span class="stringliteral">&quot;Bring interface %s down&quot;</span> % interface)</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigureBridge.html#a35cfa1d2aaf3486d6da02a2b07531ad9">netdev_down</a>(interface)</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keywordflow">if</span> destroy:</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        <a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigureBridge.html#afc46b9667e82036ac572e846ddfcd6e2">destroy_bond_device</a>(pif)</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        destroy_bridge(pif)</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div>
<div class="ttc" id="namespaceopt__xensource__libexec__InterfaceReconfigure_html_a656bc8221a4bf78465b68df92ff4f99b"><div class="ttname"><a href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#a656bc8221a4bf78465b68df92ff4f99b">opt_xensource_libexec_InterfaceReconfigure.pif_is_vlan</a></div><div class="ttdeci">def pif_is_vlan(pif)</div><div class="ttdef"><b>Definition:</b> opt_xensource_libexec_InterfaceReconfigure.py:849</div></div>
<div class="ttc" id="namespaceopt__xensource__libexec__InterfaceReconfigure_html_a4da29bd56ee69cab3f0217101f0ca090"><div class="ttname"><a href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#a4da29bd56ee69cab3f0217101f0ca090">opt_xensource_libexec_InterfaceReconfigure.pif_netdev_name</a></div><div class="ttdeci">def pif_netdev_name(pif)</div><div class="ttdef"><b>Definition:</b> opt_xensource_libexec_InterfaceReconfigure.py:761</div></div>
<div class="ttc" id="namespaceopt__xensource__libexec__InterfaceReconfigure_html_ad78039d52f55017a0486e80317c6111b"><div class="ttname"><a href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#ad78039d52f55017a0486e80317c6111b">opt_xensource_libexec_InterfaceReconfigure.netdev_exists</a></div><div class="ttdeci">def netdev_exists(netdev)</div><div class="ttdef"><b>Definition:</b> opt_xensource_libexec_InterfaceReconfigure.py:758</div></div>
<div class="ttc" id="namespaceopt__xensource__libexec__InterfaceReconfigure_html_a5a4219b402db35afa8566083452ffbf3"><div class="ttname"><a href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#a5a4219b402db35afa8566083452ffbf3">opt_xensource_libexec_InterfaceReconfigure.run_command</a></div><div class="ttdeci">def run_command(command)</div><div class="ttdef"><b>Definition:</b> opt_xensource_libexec_InterfaceReconfigure.py:62</div></div>
<div class="ttc" id="namespaceopt__xensource__libexec__InterfaceReconfigureBridge_html_afc46b9667e82036ac572e846ddfcd6e2"><div class="ttname"><a href="namespaceopt__xensource__libexec__InterfaceReconfigureBridge.html#afc46b9667e82036ac572e846ddfcd6e2">opt_xensource_libexec_InterfaceReconfigureBridge.destroy_bond_device</a></div><div class="ttdeci">def destroy_bond_device(pif)</div><div class="ttdef"><b>Definition:</b> opt_xensource_libexec_InterfaceReconfigureBridge.py:122</div></div>
<div class="ttc" id="namespaceopt__xensource__libexec__InterfaceReconfigureBridge_html_a8df3872bccb702ac68f81c828d328f28"><div class="ttname"><a href="namespaceopt__xensource__libexec__InterfaceReconfigureBridge.html#a8df3872bccb702ac68f81c828d328f28">opt_xensource_libexec_InterfaceReconfigureBridge.pif_get_bond_slaves_sorted</a></div><div class="ttdeci">def pif_get_bond_slaves_sorted(pif)</div><div class="ttdef"><b>Definition:</b> opt_xensource_libexec_InterfaceReconfigureBridge.py:290</div></div>
<div class="ttc" id="structdb_html"><div class="ttname"><a href="structdb.html">db</a></div><div class="ttdef"><b>Definition:</b> ovsdb-server.c:61</div></div>
<div class="ttc" id="namespaceopt__xensource__libexec__InterfaceReconfigureBridge_html_a35cfa1d2aaf3486d6da02a2b07531ad9"><div class="ttname"><a href="namespaceopt__xensource__libexec__InterfaceReconfigureBridge.html#a35cfa1d2aaf3486d6da02a2b07531ad9">opt_xensource_libexec_InterfaceReconfigureBridge.netdev_down</a></div><div class="ttdeci">def netdev_down(netdev)</div><div class="ttdef"><b>Definition:</b> opt_xensource_libexec_InterfaceReconfigureBridge.py:40</div></div>
<div class="ttc" id="namespaceopt__xensource__libexec__InterfaceReconfigure_html_a8580f7ecd965581201083a07509c80dd"><div class="ttname"><a href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#a8580f7ecd965581201083a07509c80dd">opt_xensource_libexec_InterfaceReconfigure.pif_get_vlan_slave</a></div><div class="ttdeci">def pif_get_vlan_slave(pif)</div><div class="ttdef"><b>Definition:</b> opt_xensource_libexec_InterfaceReconfigure.py:852</div></div>
<div class="ttc" id="namespaceopt__xensource__libexec__InterfaceReconfigure_html_a81e1358bb7be902a70a1c49a56aace63"><div class="ttname"><a href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#a81e1358bb7be902a70a1c49a56aace63">opt_xensource_libexec_InterfaceReconfigure.pif_get_vlan_masters</a></div><div class="ttdeci">def pif_get_vlan_masters(pif)</div><div class="ttdef"><b>Definition:</b> opt_xensource_libexec_InterfaceReconfigure.py:869</div></div>
<div class="ttc" id="namespaceopt__xensource__libexec__InterfaceReconfigureBridge_html_a91bdf695e53b05f0c091c7b16c79a114"><div class="ttname"><a href="namespaceopt__xensource__libexec__InterfaceReconfigureBridge.html#a91bdf695e53b05f0c091c7b16c79a114">opt_xensource_libexec_InterfaceReconfigureBridge.bring_down_interface</a></div><div class="ttdeci">def bring_down_interface</div><div class="ttdef"><b>Definition:</b> opt_xensource_libexec_InterfaceReconfigureBridge.py:142</div></div>
<div class="ttc" id="namespaceopt__xensource__libexec__InterfaceReconfigure_html_aaa3ce147731f3202a1b6b338e0b9ac88"><div class="ttname"><a href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#aaa3ce147731f3202a1b6b338e0b9ac88">opt_xensource_libexec_InterfaceReconfigure.pif_bridge_name</a></div><div class="ttdeci">def pif_bridge_name(pif)</div><div class="ttdef"><b>Definition:</b> opt_xensource_libexec_InterfaceReconfigure.py:786</div></div>
<div class="ttc" id="namespaceopt__xensource__libexec__InterfaceReconfigure_html_abd46881765b66c3cfdc50fc9bcd27fb4"><div class="ttname"><a href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#abd46881765b66c3cfdc50fc9bcd27fb4">opt_xensource_libexec_InterfaceReconfigure.log</a></div><div class="ttdeci">def log(s)</div><div class="ttdef"><b>Definition:</b> opt_xensource_libexec_InterfaceReconfigure.py:43</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a99adb97cf5abbc2f156664aad1e6467e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def opt_xensource_libexec_InterfaceReconfigureBridge.bring_up_interface </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>pif</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Bring up the interface associated with a PIF.

Also bring up the interfaces listed in additional.
</pre> <div class="fragment"><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="keyword">def </span><a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigureBridge.html#a99adb97cf5abbc2f156664aad1e6467e">bring_up_interface</a>(pif):</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;Bring up the interface associated with a PIF.</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="stringliteral">    Also bring up the interfaces listed in additional.</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="comment"># VLAN on bond seems to need bond brought up explicitly, but VLAN</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="comment"># on normal device does not. Might as well always bring it up.</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="keywordflow">if</span> <a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#a656bc8221a4bf78465b68df92ff4f99b">pif_is_vlan</a>(pif):</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        slave = <a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#a8580f7ecd965581201083a07509c80dd">pif_get_vlan_slave</a>(pif)</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        <span class="keywordflow">if</span> <span class="keywordflow">not</span> <a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigureBridge.html#ad22a20a5fe3d312f7c6c1cdaa33fb2c5">interface_is_up</a>(slave):</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            <a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigureBridge.html#a99adb97cf5abbc2f156664aad1e6467e">bring_up_interface</a>(slave)</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    interface = <a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#a4da29bd56ee69cab3f0217101f0ca090">pif_netdev_name</a>(pif)</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigureBridge.html#a57c78c2bb9fbbb613146c3b21914a081">create_bond_device</a>(pif)</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#abd46881765b66c3cfdc50fc9bcd27fb4">log</a>(<span class="stringliteral">&quot;Bring interface %s up&quot;</span> % interface)</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigureBridge.html#a20d9da72648ea002dae3fec160fed26b">netdev_up</a>(interface)</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">#</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment"># Datapath topology configuration.</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">#</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div>
<div class="ttc" id="namespaceopt__xensource__libexec__InterfaceReconfigure_html_a656bc8221a4bf78465b68df92ff4f99b"><div class="ttname"><a href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#a656bc8221a4bf78465b68df92ff4f99b">opt_xensource_libexec_InterfaceReconfigure.pif_is_vlan</a></div><div class="ttdeci">def pif_is_vlan(pif)</div><div class="ttdef"><b>Definition:</b> opt_xensource_libexec_InterfaceReconfigure.py:849</div></div>
<div class="ttc" id="namespaceopt__xensource__libexec__InterfaceReconfigure_html_a4da29bd56ee69cab3f0217101f0ca090"><div class="ttname"><a href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#a4da29bd56ee69cab3f0217101f0ca090">opt_xensource_libexec_InterfaceReconfigure.pif_netdev_name</a></div><div class="ttdeci">def pif_netdev_name(pif)</div><div class="ttdef"><b>Definition:</b> opt_xensource_libexec_InterfaceReconfigure.py:761</div></div>
<div class="ttc" id="namespaceopt__xensource__libexec__InterfaceReconfigureBridge_html_a20d9da72648ea002dae3fec160fed26b"><div class="ttname"><a href="namespaceopt__xensource__libexec__InterfaceReconfigureBridge.html#a20d9da72648ea002dae3fec160fed26b">opt_xensource_libexec_InterfaceReconfigureBridge.netdev_up</a></div><div class="ttdeci">def netdev_up</div><div class="ttdef"><b>Definition:</b> opt_xensource_libexec_InterfaceReconfigureBridge.py:47</div></div>
<div class="ttc" id="namespaceopt__xensource__libexec__InterfaceReconfigure_html_a8580f7ecd965581201083a07509c80dd"><div class="ttname"><a href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#a8580f7ecd965581201083a07509c80dd">opt_xensource_libexec_InterfaceReconfigure.pif_get_vlan_slave</a></div><div class="ttdeci">def pif_get_vlan_slave(pif)</div><div class="ttdef"><b>Definition:</b> opt_xensource_libexec_InterfaceReconfigure.py:852</div></div>
<div class="ttc" id="namespaceopt__xensource__libexec__InterfaceReconfigureBridge_html_a99adb97cf5abbc2f156664aad1e6467e"><div class="ttname"><a href="namespaceopt__xensource__libexec__InterfaceReconfigureBridge.html#a99adb97cf5abbc2f156664aad1e6467e">opt_xensource_libexec_InterfaceReconfigureBridge.bring_up_interface</a></div><div class="ttdeci">def bring_up_interface(pif)</div><div class="ttdef"><b>Definition:</b> opt_xensource_libexec_InterfaceReconfigureBridge.py:234</div></div>
<div class="ttc" id="namespaceopt__xensource__libexec__InterfaceReconfigureBridge_html_a57c78c2bb9fbbb613146c3b21914a081"><div class="ttname"><a href="namespaceopt__xensource__libexec__InterfaceReconfigureBridge.html#a57c78c2bb9fbbb613146c3b21914a081">opt_xensource_libexec_InterfaceReconfigureBridge.create_bond_device</a></div><div class="ttdeci">def create_bond_device(pif)</div><div class="ttdef"><b>Definition:</b> opt_xensource_libexec_InterfaceReconfigureBridge.py:98</div></div>
<div class="ttc" id="namespaceopt__xensource__libexec__InterfaceReconfigureBridge_html_ad22a20a5fe3d312f7c6c1cdaa33fb2c5"><div class="ttname"><a href="namespaceopt__xensource__libexec__InterfaceReconfigureBridge.html#ad22a20a5fe3d312f7c6c1cdaa33fb2c5">opt_xensource_libexec_InterfaceReconfigureBridge.interface_is_up</a></div><div class="ttdeci">def interface_is_up(pif)</div><div class="ttdef"><b>Definition:</b> opt_xensource_libexec_InterfaceReconfigureBridge.py:226</div></div>
<div class="ttc" id="namespaceopt__xensource__libexec__InterfaceReconfigure_html_abd46881765b66c3cfdc50fc9bcd27fb4"><div class="ttname"><a href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#abd46881765b66c3cfdc50fc9bcd27fb4">opt_xensource_libexec_InterfaceReconfigure.log</a></div><div class="ttdeci">def log(s)</div><div class="ttdef"><b>Definition:</b> opt_xensource_libexec_InterfaceReconfigure.py:43</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a57c78c2bb9fbbb613146c3b21914a081"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def opt_xensource_libexec_InterfaceReconfigureBridge.create_bond_device </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>pif</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Ensures that a bond master device exists in the kernel.</pre> <div class="fragment"><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="keyword">def </span><a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigureBridge.html#a57c78c2bb9fbbb613146c3b21914a081">create_bond_device</a>(pif):</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;Ensures that a bond master device exists in the kernel.&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="keywordflow">if</span> <span class="keywordflow">not</span> <a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#ae49430fe7962c1c31e3749b50c0c3d5d">pif_is_bond</a>(pif):</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <span class="keywordflow">return</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    __create_bond_device(<a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#a4da29bd56ee69cab3f0217101f0ca090">pif_netdev_name</a>(pif))</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div>
<div class="ttc" id="namespaceopt__xensource__libexec__InterfaceReconfigure_html_a4da29bd56ee69cab3f0217101f0ca090"><div class="ttname"><a href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#a4da29bd56ee69cab3f0217101f0ca090">opt_xensource_libexec_InterfaceReconfigure.pif_netdev_name</a></div><div class="ttdeci">def pif_netdev_name(pif)</div><div class="ttdef"><b>Definition:</b> opt_xensource_libexec_InterfaceReconfigure.py:761</div></div>
<div class="ttc" id="namespaceopt__xensource__libexec__InterfaceReconfigure_html_ae49430fe7962c1c31e3749b50c0c3d5d"><div class="ttname"><a href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#ae49430fe7962c1c31e3749b50c0c3d5d">opt_xensource_libexec_InterfaceReconfigure.pif_is_bond</a></div><div class="ttdeci">def pif_is_bond(pif)</div><div class="ttdef"><b>Definition:</b> opt_xensource_libexec_InterfaceReconfigure.py:802</div></div>
<div class="ttc" id="namespaceopt__xensource__libexec__InterfaceReconfigureBridge_html_a57c78c2bb9fbbb613146c3b21914a081"><div class="ttname"><a href="namespaceopt__xensource__libexec__InterfaceReconfigureBridge.html#a57c78c2bb9fbbb613146c3b21914a081">opt_xensource_libexec_InterfaceReconfigureBridge.create_bond_device</a></div><div class="ttdeci">def create_bond_device(pif)</div><div class="ttdef"><b>Definition:</b> opt_xensource_libexec_InterfaceReconfigureBridge.py:98</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="afc46b9667e82036ac572e846ddfcd6e2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def opt_xensource_libexec_InterfaceReconfigureBridge.destroy_bond_device </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>pif</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">No, Mr. Bond, I expect you to die.</pre> <div class="fragment"><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="keyword">def </span><a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigureBridge.html#afc46b9667e82036ac572e846ddfcd6e2">destroy_bond_device</a>(pif):</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;No, Mr. Bond, I expect you to die.&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    pifrec = <a class="code" href="structdb.html">db</a>().get_pif_record(pif)</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keywordflow">if</span> <span class="keywordflow">not</span> <a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#ae49430fe7962c1c31e3749b50c0c3d5d">pif_is_bond</a>(pif):</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <span class="keywordflow">return</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="comment"># If the bonding module isn&#39;t loaded then do nothing.</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keywordflow">if</span> <span class="keywordflow">not</span> os.access(sysfs_bonding_masters, os.F_OK):</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <span class="keywordflow">return</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    name = <a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#a4da29bd56ee69cab3f0217101f0ca090">pif_netdev_name</a>(pif)</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    __destroy_bond_device(name)</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">#</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment"># Bring Interface up/down.</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">#</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div>
<div class="ttc" id="namespaceopt__xensource__libexec__InterfaceReconfigure_html_a4da29bd56ee69cab3f0217101f0ca090"><div class="ttname"><a href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#a4da29bd56ee69cab3f0217101f0ca090">opt_xensource_libexec_InterfaceReconfigure.pif_netdev_name</a></div><div class="ttdeci">def pif_netdev_name(pif)</div><div class="ttdef"><b>Definition:</b> opt_xensource_libexec_InterfaceReconfigure.py:761</div></div>
<div class="ttc" id="namespaceopt__xensource__libexec__InterfaceReconfigure_html_ae49430fe7962c1c31e3749b50c0c3d5d"><div class="ttname"><a href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#ae49430fe7962c1c31e3749b50c0c3d5d">opt_xensource_libexec_InterfaceReconfigure.pif_is_bond</a></div><div class="ttdeci">def pif_is_bond(pif)</div><div class="ttdef"><b>Definition:</b> opt_xensource_libexec_InterfaceReconfigure.py:802</div></div>
<div class="ttc" id="namespaceopt__xensource__libexec__InterfaceReconfigureBridge_html_afc46b9667e82036ac572e846ddfcd6e2"><div class="ttname"><a href="namespaceopt__xensource__libexec__InterfaceReconfigureBridge.html#afc46b9667e82036ac572e846ddfcd6e2">opt_xensource_libexec_InterfaceReconfigureBridge.destroy_bond_device</a></div><div class="ttdeci">def destroy_bond_device(pif)</div><div class="ttdef"><b>Definition:</b> opt_xensource_libexec_InterfaceReconfigureBridge.py:122</div></div>
<div class="ttc" id="structdb_html"><div class="ttname"><a href="structdb.html">db</a></div><div class="ttdef"><b>Definition:</b> ovsdb-server.c:61</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad22a20a5fe3d312f7c6c1cdaa33fb2c5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def opt_xensource_libexec_InterfaceReconfigureBridge.interface_is_up </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>pif</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="keyword">def </span><a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigureBridge.html#ad22a20a5fe3d312f7c6c1cdaa33fb2c5">interface_is_up</a>(pif):</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keywordflow">try</span>:</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        interface = <a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#a4da29bd56ee69cab3f0217101f0ca090">pif_netdev_name</a>(pif)</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        state = open(<span class="stringliteral">&quot;%s/sys/class/net/%s/operstate&quot;</span> % (<a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#ab95a81c16d03fa644cfce0f9bb204a2e">root_prefix</a>(), interface)).read().strip()</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <span class="keywordflow">return</span> state == <span class="stringliteral">&quot;up&quot;</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="keywordflow">except</span>:</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">False</span> <span class="comment"># interface prolly doesn&#39;t exist</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div>
<div class="ttc" id="namespaceopt__xensource__libexec__InterfaceReconfigure_html_a4da29bd56ee69cab3f0217101f0ca090"><div class="ttname"><a href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#a4da29bd56ee69cab3f0217101f0ca090">opt_xensource_libexec_InterfaceReconfigure.pif_netdev_name</a></div><div class="ttdeci">def pif_netdev_name(pif)</div><div class="ttdef"><b>Definition:</b> opt_xensource_libexec_InterfaceReconfigure.py:761</div></div>
<div class="ttc" id="namespaceopt__xensource__libexec__InterfaceReconfigure_html_ab95a81c16d03fa644cfce0f9bb204a2e"><div class="ttname"><a href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#ab95a81c16d03fa644cfce0f9bb204a2e">opt_xensource_libexec_InterfaceReconfigure.root_prefix</a></div><div class="ttdeci">def root_prefix()</div><div class="ttdef"><b>Definition:</b> opt_xensource_libexec_InterfaceReconfigure.py:21</div></div>
<div class="ttc" id="namespaceopt__xensource__libexec__InterfaceReconfigureBridge_html_ad22a20a5fe3d312f7c6c1cdaa33fb2c5"><div class="ttname"><a href="namespaceopt__xensource__libexec__InterfaceReconfigureBridge.html#ad22a20a5fe3d312f7c6c1cdaa33fb2c5">opt_xensource_libexec_InterfaceReconfigureBridge.interface_is_up</a></div><div class="ttdeci">def interface_is_up(pif)</div><div class="ttdef"><b>Definition:</b> opt_xensource_libexec_InterfaceReconfigureBridge.py:226</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa40116fa5a648076e3f4d415f69157b0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def opt_xensource_libexec_InterfaceReconfigureBridge.load_bonding_driver </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="keyword">def </span><a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigureBridge.html#aa40116fa5a648076e3f4d415f69157b0">load_bonding_driver</a>():</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#abd46881765b66c3cfdc50fc9bcd27fb4">log</a>(<span class="stringliteral">&quot;Loading bonding driver&quot;</span>)</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#a5a4219b402db35afa8566083452ffbf3">run_command</a>([<span class="stringliteral">&quot;/sbin/modprobe&quot;</span>, <span class="stringliteral">&quot;bonding&quot;</span>])</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="keywordflow">try</span>:</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <span class="comment"># bond_device_exists() uses the contents of sysfs_bonding_masters to work out which devices</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        <span class="comment"># have already been created.  Unfortunately the driver creates &quot;bond0&quot; automatically at</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <span class="comment"># modprobe init.  Get rid of this now or our accounting will go wrong.</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        f = open(sysfs_bonding_masters, <span class="stringliteral">&quot;w&quot;</span>)</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        f.write(<span class="stringliteral">&quot;-bond0&quot;</span>)</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        f.close()</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keywordflow">except</span> IOError, e:</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        <a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#abd46881765b66c3cfdc50fc9bcd27fb4">log</a>(<span class="stringliteral">&quot;Failed to load bonding driver: %s&quot;</span> % e)</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div>
<div class="ttc" id="namespaceopt__xensource__libexec__InterfaceReconfigure_html_a5a4219b402db35afa8566083452ffbf3"><div class="ttname"><a href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#a5a4219b402db35afa8566083452ffbf3">opt_xensource_libexec_InterfaceReconfigure.run_command</a></div><div class="ttdeci">def run_command(command)</div><div class="ttdef"><b>Definition:</b> opt_xensource_libexec_InterfaceReconfigure.py:62</div></div>
<div class="ttc" id="namespaceopt__xensource__libexec__InterfaceReconfigureBridge_html_aa40116fa5a648076e3f4d415f69157b0"><div class="ttname"><a href="namespaceopt__xensource__libexec__InterfaceReconfigureBridge.html#aa40116fa5a648076e3f4d415f69157b0">opt_xensource_libexec_InterfaceReconfigureBridge.load_bonding_driver</a></div><div class="ttdeci">def load_bonding_driver()</div><div class="ttdef"><b>Definition:</b> opt_xensource_libexec_InterfaceReconfigureBridge.py:58</div></div>
<div class="ttc" id="namespaceopt__xensource__libexec__InterfaceReconfigure_html_abd46881765b66c3cfdc50fc9bcd27fb4"><div class="ttname"><a href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#abd46881765b66c3cfdc50fc9bcd27fb4">opt_xensource_libexec_InterfaceReconfigure.log</a></div><div class="ttdeci">def log(s)</div><div class="ttdef"><b>Definition:</b> opt_xensource_libexec_InterfaceReconfigure.py:43</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a35cfa1d2aaf3486d6da02a2b07531ad9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def opt_xensource_libexec_InterfaceReconfigureBridge.netdev_down </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>netdev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Bring down a bare network device</pre> <div class="fragment"><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="keyword">def </span><a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigureBridge.html#a35cfa1d2aaf3486d6da02a2b07531ad9">netdev_down</a>(netdev):</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;Bring down a bare network device&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="keywordflow">if</span> <span class="keywordflow">not</span> <a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#ad78039d52f55017a0486e80317c6111b">netdev_exists</a>(netdev):</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        <a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#abd46881765b66c3cfdc50fc9bcd27fb4">log</a>(<span class="stringliteral">&quot;netdev: down: device %s does not exist, ignoring&quot;</span> % netdev)</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        <span class="keywordflow">return</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#a5a4219b402db35afa8566083452ffbf3">run_command</a>([<span class="stringliteral">&quot;/sbin/ifdown&quot;</span>, netdev])</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div>
<div class="ttc" id="namespaceopt__xensource__libexec__InterfaceReconfigure_html_ad78039d52f55017a0486e80317c6111b"><div class="ttname"><a href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#ad78039d52f55017a0486e80317c6111b">opt_xensource_libexec_InterfaceReconfigure.netdev_exists</a></div><div class="ttdeci">def netdev_exists(netdev)</div><div class="ttdef"><b>Definition:</b> opt_xensource_libexec_InterfaceReconfigure.py:758</div></div>
<div class="ttc" id="namespaceopt__xensource__libexec__InterfaceReconfigure_html_a5a4219b402db35afa8566083452ffbf3"><div class="ttname"><a href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#a5a4219b402db35afa8566083452ffbf3">opt_xensource_libexec_InterfaceReconfigure.run_command</a></div><div class="ttdeci">def run_command(command)</div><div class="ttdef"><b>Definition:</b> opt_xensource_libexec_InterfaceReconfigure.py:62</div></div>
<div class="ttc" id="namespaceopt__xensource__libexec__InterfaceReconfigureBridge_html_a35cfa1d2aaf3486d6da02a2b07531ad9"><div class="ttname"><a href="namespaceopt__xensource__libexec__InterfaceReconfigureBridge.html#a35cfa1d2aaf3486d6da02a2b07531ad9">opt_xensource_libexec_InterfaceReconfigureBridge.netdev_down</a></div><div class="ttdeci">def netdev_down(netdev)</div><div class="ttdef"><b>Definition:</b> opt_xensource_libexec_InterfaceReconfigureBridge.py:40</div></div>
<div class="ttc" id="namespaceopt__xensource__libexec__InterfaceReconfigure_html_abd46881765b66c3cfdc50fc9bcd27fb4"><div class="ttname"><a href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#abd46881765b66c3cfdc50fc9bcd27fb4">opt_xensource_libexec_InterfaceReconfigure.log</a></div><div class="ttdeci">def log(s)</div><div class="ttdef"><b>Definition:</b> opt_xensource_libexec_InterfaceReconfigure.py:43</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a20d9da72648ea002dae3fec160fed26b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def opt_xensource_libexec_InterfaceReconfigureBridge.netdev_up </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>netdev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>mtu</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Bring up a bare network device</pre> <div class="fragment"><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="keyword">def </span><a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigureBridge.html#a20d9da72648ea002dae3fec160fed26b">netdev_up</a>(netdev, mtu=None):</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;Bring up a bare network device&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="comment">#if not netdev_exists(netdev):</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="comment">#    raise Error(&quot;netdev: up: device %s does not exist&quot; % netdev)</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#a5a4219b402db35afa8566083452ffbf3">run_command</a>([<span class="stringliteral">&quot;/sbin/ifup&quot;</span>, netdev])</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">#</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment"># Bonding driver</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">#</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div>
<div class="ttc" id="namespaceopt__xensource__libexec__InterfaceReconfigure_html_a5a4219b402db35afa8566083452ffbf3"><div class="ttname"><a href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#a5a4219b402db35afa8566083452ffbf3">opt_xensource_libexec_InterfaceReconfigure.run_command</a></div><div class="ttdeci">def run_command(command)</div><div class="ttdef"><b>Definition:</b> opt_xensource_libexec_InterfaceReconfigure.py:62</div></div>
<div class="ttc" id="namespaceopt__xensource__libexec__InterfaceReconfigureBridge_html_a20d9da72648ea002dae3fec160fed26b"><div class="ttname"><a href="namespaceopt__xensource__libexec__InterfaceReconfigureBridge.html#a20d9da72648ea002dae3fec160fed26b">opt_xensource_libexec_InterfaceReconfigureBridge.netdev_up</a></div><div class="ttdeci">def netdev_up</div><div class="ttdef"><b>Definition:</b> opt_xensource_libexec_InterfaceReconfigureBridge.py:47</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a20308e0c4784fcfcc26e0e371513e031"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def opt_xensource_libexec_InterfaceReconfigureBridge.open_pif_ifcfg </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>pif</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="keyword">def </span><a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigureBridge.html#a20308e0c4784fcfcc26e0e371513e031">open_pif_ifcfg</a>(pif):</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    pifrec = <a class="code" href="structdb.html">db</a>().get_pif_record(pif)</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    interface = <a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#a4da29bd56ee69cab3f0217101f0ca090">pif_netdev_name</a>(pif)</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#abd46881765b66c3cfdc50fc9bcd27fb4">log</a>(<span class="stringliteral">&quot;Configuring %s (%s)&quot;</span> % (interface, pifrec[<span class="stringliteral">&#39;MAC&#39;</span>]))</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    f = ConfigurationFile(<span class="stringliteral">&quot;%s/etc/sysconfig/network-scripts/ifcfg-%s&quot;</span> % (<a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#ab95a81c16d03fa644cfce0f9bb204a2e">root_prefix</a>(), interface))</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    f.write(<span class="stringliteral">&quot;# DO NOT EDIT: This file (%s) was autogenerated by %s\n&quot;</span> % \</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;            (os.path.basename(f.path()), os.path.basename(sys.argv[0])))</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    f.write(<span class="stringliteral">&quot;XEMANAGED=yes\n&quot;</span>)</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    f.write(<span class="stringliteral">&quot;DEVICE=%s\n&quot;</span> % interface)</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    f.write(<span class="stringliteral">&quot;ONBOOT=no\n&quot;</span>)</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="keywordflow">return</span> f</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">#</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment"># Bare Network Devices -- network devices without IP configuration</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">#</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div>
<div class="ttc" id="namespaceopt__xensource__libexec__InterfaceReconfigure_html_a4da29bd56ee69cab3f0217101f0ca090"><div class="ttname"><a href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#a4da29bd56ee69cab3f0217101f0ca090">opt_xensource_libexec_InterfaceReconfigure.pif_netdev_name</a></div><div class="ttdeci">def pif_netdev_name(pif)</div><div class="ttdef"><b>Definition:</b> opt_xensource_libexec_InterfaceReconfigure.py:761</div></div>
<div class="ttc" id="namespaceopt__xensource__libexec__InterfaceReconfigure_html_ab95a81c16d03fa644cfce0f9bb204a2e"><div class="ttname"><a href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#ab95a81c16d03fa644cfce0f9bb204a2e">opt_xensource_libexec_InterfaceReconfigure.root_prefix</a></div><div class="ttdeci">def root_prefix()</div><div class="ttdef"><b>Definition:</b> opt_xensource_libexec_InterfaceReconfigure.py:21</div></div>
<div class="ttc" id="structdb_html"><div class="ttname"><a href="structdb.html">db</a></div><div class="ttdef"><b>Definition:</b> ovsdb-server.c:61</div></div>
<div class="ttc" id="namespaceopt__xensource__libexec__InterfaceReconfigure_html_abd46881765b66c3cfdc50fc9bcd27fb4"><div class="ttname"><a href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#abd46881765b66c3cfdc50fc9bcd27fb4">opt_xensource_libexec_InterfaceReconfigure.log</a></div><div class="ttdeci">def log(s)</div><div class="ttdef"><b>Definition:</b> opt_xensource_libexec_InterfaceReconfigure.py:43</div></div>
<div class="ttc" id="namespaceopt__xensource__libexec__InterfaceReconfigureBridge_html_a20308e0c4784fcfcc26e0e371513e031"><div class="ttname"><a href="namespaceopt__xensource__libexec__InterfaceReconfigureBridge.html#a20308e0c4784fcfcc26e0e371513e031">opt_xensource_libexec_InterfaceReconfigureBridge.open_pif_ifcfg</a></div><div class="ttdeci">def open_pif_ifcfg(pif)</div><div class="ttdef"><b>Definition:</b> opt_xensource_libexec_InterfaceReconfigureBridge.py:20</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8df3872bccb702ac68f81c828d328f28"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def opt_xensource_libexec_InterfaceReconfigureBridge.pif_get_bond_slaves_sorted </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>pif</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="keyword">def </span><a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigureBridge.html#a8df3872bccb702ac68f81c828d328f28">pif_get_bond_slaves_sorted</a>(pif):</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    pifrec = <a class="code" href="structdb.html">db</a>().get_pif_record(pif)</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="comment"># build a list of slave&#39;s pifs</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    slave_pifs = <a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#ab202ba00dd230b7f383702918f9e12f6">pif_get_bond_slaves</a>(pif)</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="comment"># Ensure any currently attached slaves are listed in the opposite order to the order in</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="comment"># which they were attached.  The first slave attached must be the last detached since</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="comment"># the bond is using its MAC address.</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="keywordflow">try</span>:</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        attached_slaves = open(<span class="stringliteral">&quot;%s/sys/class/net/%s/bonding/slaves&quot;</span> % (<a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#ab95a81c16d03fa644cfce0f9bb204a2e">root_prefix</a>(), pifrec[<span class="stringliteral">&#39;device&#39;</span>])).readline().split()</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        <span class="keywordflow">for</span> slave <span class="keywordflow">in</span> attached_slaves:</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            pifs = [p <span class="keywordflow">for</span> p <span class="keywordflow">in</span> <a class="code" href="structdb.html">db</a>().get_pifs_by_device(slave) <span class="keywordflow">if</span> <span class="keywordflow">not</span> <a class="code" href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#a656bc8221a4bf78465b68df92ff4f99b">pif_is_vlan</a>(p)]</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            slave_pif = pifs[0]</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;            slave_pifs.remove(slave_pif)</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;            slave_pifs.insert(0, slave_pif)</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="keywordflow">except</span> IOError:</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        <span class="keywordflow">pass</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keywordflow">return</span> slave_pifs</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div>
<div class="ttc" id="namespaceopt__xensource__libexec__InterfaceReconfigure_html_a656bc8221a4bf78465b68df92ff4f99b"><div class="ttname"><a href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#a656bc8221a4bf78465b68df92ff4f99b">opt_xensource_libexec_InterfaceReconfigure.pif_is_vlan</a></div><div class="ttdeci">def pif_is_vlan(pif)</div><div class="ttdef"><b>Definition:</b> opt_xensource_libexec_InterfaceReconfigure.py:849</div></div>
<div class="ttc" id="namespaceopt__xensource__libexec__InterfaceReconfigure_html_ab95a81c16d03fa644cfce0f9bb204a2e"><div class="ttname"><a href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#ab95a81c16d03fa644cfce0f9bb204a2e">opt_xensource_libexec_InterfaceReconfigure.root_prefix</a></div><div class="ttdeci">def root_prefix()</div><div class="ttdef"><b>Definition:</b> opt_xensource_libexec_InterfaceReconfigure.py:21</div></div>
<div class="ttc" id="namespaceopt__xensource__libexec__InterfaceReconfigure_html_ab202ba00dd230b7f383702918f9e12f6"><div class="ttname"><a href="namespaceopt__xensource__libexec__InterfaceReconfigure.html#ab202ba00dd230b7f383702918f9e12f6">opt_xensource_libexec_InterfaceReconfigure.pif_get_bond_slaves</a></div><div class="ttdeci">def pif_get_bond_slaves(pif)</div><div class="ttdef"><b>Definition:</b> opt_xensource_libexec_InterfaceReconfigure.py:827</div></div>
<div class="ttc" id="namespaceopt__xensource__libexec__InterfaceReconfigureBridge_html_a8df3872bccb702ac68f81c828d328f28"><div class="ttname"><a href="namespaceopt__xensource__libexec__InterfaceReconfigureBridge.html#a8df3872bccb702ac68f81c828d328f28">opt_xensource_libexec_InterfaceReconfigureBridge.pif_get_bond_slaves_sorted</a></div><div class="ttdeci">def pif_get_bond_slaves_sorted(pif)</div><div class="ttdef"><b>Definition:</b> opt_xensource_libexec_InterfaceReconfigureBridge.py:290</div></div>
<div class="ttc" id="structdb_html"><div class="ttname"><a href="structdb.html">db</a></div><div class="ttdef"><b>Definition:</b> ovsdb-server.c:61</div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a4d32cb6285c1b0feb36a4059142ff237"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">tuple opt_xensource_libexec_InterfaceReconfigureBridge.sysfs_bonding_masters = root_prefix()</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceopt__xensource__libexec__InterfaceReconfigureBridge.html">opt_xensource_libexec_InterfaceReconfigureBridge</a></li>
    <li class="footer">Generated on Wed Sep 9 2015 19:08:09 for ovs all by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.9.1 </li>
  </ul>
</div>
</body>
</html>
