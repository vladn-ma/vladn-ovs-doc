\hypertarget{net_2udp_8h}{}\section{/home/vladn/git/ovs/datapath/linux/compat/include/net/udp.h File Reference}
\label{net_2udp_8h}\index{/home/vladn/git/ovs/datapath/linux/compat/include/net/udp.\+h@{/home/vladn/git/ovs/datapath/linux/compat/include/net/udp.\+h}}
{\ttfamily \#include $<$linux/version.\+h$>$}\\*
Include dependency graph for udp.\+h\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=196pt]{net_2udp_8h__incl}
\end{center}
\end{figure}
This graph shows which files directly or indirectly include this file\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{net_2udp_8h__dep__incl}
\end{center}
\end{figure}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{net_2udp_8h_afe6572fca30bf3135b12944bcd7e6c39}{udp\+\_\+flow\+\_\+src\+\_\+port}~\hyperlink{net_2udp_8h_a7f9a31b347f21b498cf07d2418675a8c}{rpl\+\_\+udp\+\_\+flow\+\_\+src\+\_\+port}
\item 
\#define \hyperlink{net_2udp_8h_a7e7cc5b413d568841dc9dd3efe57f1ac}{udp\+\_\+set\+\_\+csum}~\hyperlink{udp_8c_a45502e41e2d5e1b9d7cc067bb6924f6b}{rpl\+\_\+udp\+\_\+set\+\_\+csum}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
static \+\_\+\+\_\+be16 \hyperlink{net_2udp_8h_a7f9a31b347f21b498cf07d2418675a8c}{rpl\+\_\+udp\+\_\+flow\+\_\+src\+\_\+port} (struct net $\ast$net, struct sk\+\_\+buff $\ast$skb, int min, int max, \hyperlink{types_8h_afaa87723b8417d40fcf45b7330261ef9}{bool} use\+\_\+eth)
\item 
static \hyperlink{types_8h_a2fdf5566d289d6941c29db084139bf23}{\+\_\+\+\_\+sum16} \hyperlink{net_2udp_8h_ae748c37ebf3ca7c1fb8dfa45bb547486}{udp\+\_\+v4\+\_\+check} (int len, \+\_\+\+\_\+be32 saddr, \+\_\+\+\_\+be32 daddr, \hyperlink{types_8h_a8970faa9ec4200c98293ac50174b9206}{\+\_\+\+\_\+wsum} base)
\item 
void \hyperlink{net_2udp_8h_a45502e41e2d5e1b9d7cc067bb6924f6b}{rpl\+\_\+udp\+\_\+set\+\_\+csum} (\hyperlink{types_8h_afaa87723b8417d40fcf45b7330261ef9}{bool} nocheck, struct sk\+\_\+buff $\ast$skb, \+\_\+\+\_\+be32 saddr, \+\_\+\+\_\+be32 daddr, int len)
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\hypertarget{net_2udp_8h_afe6572fca30bf3135b12944bcd7e6c39}{}\index{net/udp.\+h@{net/udp.\+h}!udp\+\_\+flow\+\_\+src\+\_\+port@{udp\+\_\+flow\+\_\+src\+\_\+port}}
\index{udp\+\_\+flow\+\_\+src\+\_\+port@{udp\+\_\+flow\+\_\+src\+\_\+port}!net/udp.\+h@{net/udp.\+h}}
\subsubsection[{udp\+\_\+flow\+\_\+src\+\_\+port}]{\setlength{\rightskip}{0pt plus 5cm}\#define udp\+\_\+flow\+\_\+src\+\_\+port~{\bf rpl\+\_\+udp\+\_\+flow\+\_\+src\+\_\+port}}\label{net_2udp_8h_afe6572fca30bf3135b12944bcd7e6c39}
\hypertarget{net_2udp_8h_a7e7cc5b413d568841dc9dd3efe57f1ac}{}\index{net/udp.\+h@{net/udp.\+h}!udp\+\_\+set\+\_\+csum@{udp\+\_\+set\+\_\+csum}}
\index{udp\+\_\+set\+\_\+csum@{udp\+\_\+set\+\_\+csum}!net/udp.\+h@{net/udp.\+h}}
\subsubsection[{udp\+\_\+set\+\_\+csum}]{\setlength{\rightskip}{0pt plus 5cm}\#define udp\+\_\+set\+\_\+csum~{\bf rpl\+\_\+udp\+\_\+set\+\_\+csum}}\label{net_2udp_8h_a7e7cc5b413d568841dc9dd3efe57f1ac}


\subsection{Function Documentation}
\hypertarget{net_2udp_8h_a7f9a31b347f21b498cf07d2418675a8c}{}\index{net/udp.\+h@{net/udp.\+h}!rpl\+\_\+udp\+\_\+flow\+\_\+src\+\_\+port@{rpl\+\_\+udp\+\_\+flow\+\_\+src\+\_\+port}}
\index{rpl\+\_\+udp\+\_\+flow\+\_\+src\+\_\+port@{rpl\+\_\+udp\+\_\+flow\+\_\+src\+\_\+port}!net/udp.\+h@{net/udp.\+h}}
\subsubsection[{rpl\+\_\+udp\+\_\+flow\+\_\+src\+\_\+port}]{\setlength{\rightskip}{0pt plus 5cm}static \+\_\+\+\_\+be16 rpl\+\_\+udp\+\_\+flow\+\_\+src\+\_\+port (
\begin{DoxyParamCaption}
\item[{struct net $\ast$}]{net, }
\item[{struct sk\+\_\+buff $\ast$}]{skb, }
\item[{int}]{min, }
\item[{int}]{max, }
\item[{{\bf bool}}]{use\+\_\+eth}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}\label{net_2udp_8h_a7f9a31b347f21b498cf07d2418675a8c}

\begin{DoxyCode}
19 \{
20     u32 hash;
21 
22     \textcolor{keywordflow}{if} (min >= max) \{
23         \textcolor{comment}{/* Use default range */}
24         \hyperlink{net_2ip_8h_a2fa8d50303354dc298e21be296cd999f}{inet\_get\_local\_port\_range}(net, &min, &max);
25     \}
26 
27     hash = \hyperlink{skbuff_8h_acb236314b209f764af9aae7fbbb04311}{skb\_get\_hash}(skb);
28     \textcolor{keywordflow}{if} (unlikely(!hash) && use\_eth) \{
29         \textcolor{comment}{/* Can't find a normal hash, caller has indicated an Ethernet}
30 \textcolor{comment}{         * packet so use that to compute a hash.}
31 \textcolor{comment}{         */}
32         hash = jhash(skb->data, 2 * ETH\_ALEN,
33                  (\_\_force u32) skb->protocol);
34     \}
35 
36     \textcolor{comment}{/* Since this is being sent on the wire obfuscate hash a bit}
37 \textcolor{comment}{     * to minimize possbility that any useful information to an}
38 \textcolor{comment}{     * attacker is leaked. Only upper 16 bits are relevant in the}
39 \textcolor{comment}{     * computation for 16 bit port value.}
40 \textcolor{comment}{     */}
41     hash ^= hash << 16;
42 
43     \textcolor{keywordflow}{return} htons((((u64) hash * (max - min)) >> 32) + min);
44 \}
\end{DoxyCode}
\hypertarget{net_2udp_8h_a45502e41e2d5e1b9d7cc067bb6924f6b}{}\index{net/udp.\+h@{net/udp.\+h}!rpl\+\_\+udp\+\_\+set\+\_\+csum@{rpl\+\_\+udp\+\_\+set\+\_\+csum}}
\index{rpl\+\_\+udp\+\_\+set\+\_\+csum@{rpl\+\_\+udp\+\_\+set\+\_\+csum}!net/udp.\+h@{net/udp.\+h}}
\subsubsection[{rpl\+\_\+udp\+\_\+set\+\_\+csum}]{\setlength{\rightskip}{0pt plus 5cm}void rpl\+\_\+udp\+\_\+set\+\_\+csum (
\begin{DoxyParamCaption}
\item[{{\bf bool}}]{nocheck, }
\item[{struct sk\+\_\+buff $\ast$}]{skb, }
\item[{\+\_\+\+\_\+be32}]{saddr, }
\item[{\+\_\+\+\_\+be32}]{daddr, }
\item[{int}]{len}
\end{DoxyParamCaption}
)}\label{net_2udp_8h_a45502e41e2d5e1b9d7cc067bb6924f6b}

\begin{DoxyCode}
12 \{
13     \textcolor{keyword}{struct }udphdr *uh = \hyperlink{linux_2udp_8h_a7b8908e197538768cf4ff9ec577bd86b}{udp\_hdr}(skb);
14 
15     \textcolor{keywordflow}{if} (nocheck)
16         uh->check = 0;
17     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (skb\_is\_gso(skb))
18         uh->check = ~\hyperlink{net_2udp_8h_ae748c37ebf3ca7c1fb8dfa45bb547486}{udp\_v4\_check}(len, saddr, daddr, 0);
19     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\hyperlink{skbuff_8h_abad96939496a915ab2a3e7c3b6d4498f}{skb\_dst}(skb) && \hyperlink{skbuff_8h_abad96939496a915ab2a3e7c3b6d4498f}{skb\_dst}(skb)->dev &&
20          (\hyperlink{skbuff_8h_abad96939496a915ab2a3e7c3b6d4498f}{skb\_dst}(skb)->dev->features & NETIF\_F\_V4\_CSUM)) \{
21 
22         BUG\_ON(skb->ip\_summed == \hyperlink{skbuff_8h_a627906a22e9d4cb31c7674b86eb25ef3}{CHECKSUM\_PARTIAL});
23 
24         skb->ip\_summed = \hyperlink{skbuff_8h_a627906a22e9d4cb31c7674b86eb25ef3}{CHECKSUM\_PARTIAL};
25         skb->csum\_start = \hyperlink{skbuff_8h_ad4a95a26793695e82fca60888688450f}{skb\_transport\_header}(skb) - skb->head;
26         skb->csum\_offset = offsetof(\textcolor{keyword}{struct} udphdr, check);
27         uh->check = ~\hyperlink{net_2udp_8h_ae748c37ebf3ca7c1fb8dfa45bb547486}{udp\_v4\_check}(len, saddr, daddr, 0);
28     \} \textcolor{keywordflow}{else} \{
29         \hyperlink{types_8h_a8970faa9ec4200c98293ac50174b9206}{\_\_wsum} csum;
30 
31         BUG\_ON(skb->ip\_summed == \hyperlink{skbuff_8h_a627906a22e9d4cb31c7674b86eb25ef3}{CHECKSUM\_PARTIAL});
32 
33         uh->check = 0;
34         csum = skb\_checksum(skb, 0, len, 0);
35         uh->check = \hyperlink{net_2udp_8h_ae748c37ebf3ca7c1fb8dfa45bb547486}{udp\_v4\_check}(len, saddr, daddr, csum);
36         \textcolor{keywordflow}{if} (uh->check == 0)
37             uh->check = \hyperlink{checksum_8h_a444eeba1f6868a156bcc975cd9963d63}{CSUM\_MANGLED\_0};
38 
39         skb->ip\_summed = CHECKSUM\_UNNECESSARY;
40     \}
41 \}
\end{DoxyCode}
\hypertarget{net_2udp_8h_ae748c37ebf3ca7c1fb8dfa45bb547486}{}\index{net/udp.\+h@{net/udp.\+h}!udp\+\_\+v4\+\_\+check@{udp\+\_\+v4\+\_\+check}}
\index{udp\+\_\+v4\+\_\+check@{udp\+\_\+v4\+\_\+check}!net/udp.\+h@{net/udp.\+h}}
\subsubsection[{udp\+\_\+v4\+\_\+check}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf \+\_\+\+\_\+sum16} udp\+\_\+v4\+\_\+check (
\begin{DoxyParamCaption}
\item[{int}]{len, }
\item[{\+\_\+\+\_\+be32}]{saddr, }
\item[{\+\_\+\+\_\+be32}]{daddr, }
\item[{{\bf \+\_\+\+\_\+wsum}}]{base}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}\label{net_2udp_8h_ae748c37ebf3ca7c1fb8dfa45bb547486}

\begin{DoxyCode}
52 \{
53     \textcolor{keywordflow}{return} csum\_tcpudp\_magic(saddr, daddr, len, IPPROTO\_UDP, base);
54 \}
\end{DoxyCode}
