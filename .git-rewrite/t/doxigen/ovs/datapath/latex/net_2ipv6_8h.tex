\hypertarget{net_2ipv6_8h}{}\section{/home/vladn/git/ovs/datapath/linux/compat/include/net/ipv6.h File Reference}
\label{net_2ipv6_8h}\index{/home/vladn/git/ovs/datapath/linux/compat/include/net/ipv6.\+h@{/home/vladn/git/ovs/datapath/linux/compat/include/net/ipv6.\+h}}
{\ttfamily \#include $<$linux/version.\+h$>$}\\*
Include dependency graph for ipv6.\+h\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=196pt]{net_2ipv6_8h__incl}
\end{center}
\end{figure}
This graph shows which files directly or indirectly include this file\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{net_2ipv6_8h__dep__incl}
\end{center}
\end{figure}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{net_2ipv6_8h_a1135c535edd95af9465ce2921dd31c28}{N\+E\+X\+T\+H\+D\+R\+\_\+\+S\+C\+T\+P}~132 /$\ast$ Stream Control Transport Protocol $\ast$/
\item 
\#define \hyperlink{net_2ipv6_8h_a19e9ca56f1d4e55fcab51b3e6892a6ab}{ipv6\+\_\+find\+\_\+hdr}~\hyperlink{exthdrs__core_8c_a9dac58bb4c09331136a03725c3fd8d71}{rpl\+\_\+ipv6\+\_\+find\+\_\+hdr}
\end{DoxyCompactItemize}
\subsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \{ \hyperlink{net_2ipv6_8h_ab48899087cc647f0f791ed0c459adc53a896e48b555d0207d316edb0043e46882}{I\+P6\+\_\+\+F\+H\+\_\+\+F\+\_\+\+F\+R\+A\+G} = (1 $<$$<$ 0), 
\hyperlink{net_2ipv6_8h_ab48899087cc647f0f791ed0c459adc53a39098fe882a26a0617bd71ad4d06c85a}{I\+P6\+\_\+\+F\+H\+\_\+\+F\+\_\+\+A\+U\+T\+H} = (1 $<$$<$ 1), 
\hyperlink{net_2ipv6_8h_ab48899087cc647f0f791ed0c459adc53ae061c21caac2cca8aed854ed6fb1fa61}{I\+P6\+\_\+\+F\+H\+\_\+\+F\+\_\+\+S\+K\+I\+P\+\_\+\+R\+H} = (1 $<$$<$ 2)
 \}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{net_2ipv6_8h_a532005f62f05cefdb81971e7c338d74d}{rpl\+\_\+ipv6\+\_\+find\+\_\+hdr} (const struct sk\+\_\+buff $\ast$skb, unsigned int $\ast$offset, int \hyperlink{flow_8h_a5fb304013ae6aaeaee9d7fdcfd343292}{target}, unsigned short $\ast$fragoff, int $\ast$fragflg)
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\hypertarget{net_2ipv6_8h_a19e9ca56f1d4e55fcab51b3e6892a6ab}{}\index{net/ipv6.\+h@{net/ipv6.\+h}!ipv6\+\_\+find\+\_\+hdr@{ipv6\+\_\+find\+\_\+hdr}}
\index{ipv6\+\_\+find\+\_\+hdr@{ipv6\+\_\+find\+\_\+hdr}!net/ipv6.\+h@{net/ipv6.\+h}}
\subsubsection[{ipv6\+\_\+find\+\_\+hdr}]{\setlength{\rightskip}{0pt plus 5cm}\#define ipv6\+\_\+find\+\_\+hdr~{\bf rpl\+\_\+ipv6\+\_\+find\+\_\+hdr}}\label{net_2ipv6_8h_a19e9ca56f1d4e55fcab51b3e6892a6ab}
\hypertarget{net_2ipv6_8h_a1135c535edd95af9465ce2921dd31c28}{}\index{net/ipv6.\+h@{net/ipv6.\+h}!N\+E\+X\+T\+H\+D\+R\+\_\+\+S\+C\+T\+P@{N\+E\+X\+T\+H\+D\+R\+\_\+\+S\+C\+T\+P}}
\index{N\+E\+X\+T\+H\+D\+R\+\_\+\+S\+C\+T\+P@{N\+E\+X\+T\+H\+D\+R\+\_\+\+S\+C\+T\+P}!net/ipv6.\+h@{net/ipv6.\+h}}
\subsubsection[{N\+E\+X\+T\+H\+D\+R\+\_\+\+S\+C\+T\+P}]{\setlength{\rightskip}{0pt plus 5cm}\#define N\+E\+X\+T\+H\+D\+R\+\_\+\+S\+C\+T\+P~132 /$\ast$ Stream Control Transport Protocol $\ast$/}\label{net_2ipv6_8h_a1135c535edd95af9465ce2921dd31c28}


\subsection{Enumeration Type Documentation}
\hypertarget{net_2ipv6_8h_ab48899087cc647f0f791ed0c459adc53}{}\subsubsection[{anonymous enum}]{\setlength{\rightskip}{0pt plus 5cm}anonymous enum}\label{net_2ipv6_8h_ab48899087cc647f0f791ed0c459adc53}
\begin{Desc}
\item[Enumerator]\par
\begin{description}
\index{I\+P6\+\_\+\+F\+H\+\_\+\+F\+\_\+\+F\+R\+A\+G@{I\+P6\+\_\+\+F\+H\+\_\+\+F\+\_\+\+F\+R\+A\+G}!net/ipv6.\+h@{net/ipv6.\+h}}\index{net/ipv6.\+h@{net/ipv6.\+h}!I\+P6\+\_\+\+F\+H\+\_\+\+F\+\_\+\+F\+R\+A\+G@{I\+P6\+\_\+\+F\+H\+\_\+\+F\+\_\+\+F\+R\+A\+G}}\item[{\em 
\hypertarget{net_2ipv6_8h_ab48899087cc647f0f791ed0c459adc53a896e48b555d0207d316edb0043e46882}{}I\+P6\+\_\+\+F\+H\+\_\+\+F\+\_\+\+F\+R\+A\+G\label{net_2ipv6_8h_ab48899087cc647f0f791ed0c459adc53a896e48b555d0207d316edb0043e46882}
}]\index{I\+P6\+\_\+\+F\+H\+\_\+\+F\+\_\+\+A\+U\+T\+H@{I\+P6\+\_\+\+F\+H\+\_\+\+F\+\_\+\+A\+U\+T\+H}!net/ipv6.\+h@{net/ipv6.\+h}}\index{net/ipv6.\+h@{net/ipv6.\+h}!I\+P6\+\_\+\+F\+H\+\_\+\+F\+\_\+\+A\+U\+T\+H@{I\+P6\+\_\+\+F\+H\+\_\+\+F\+\_\+\+A\+U\+T\+H}}\item[{\em 
\hypertarget{net_2ipv6_8h_ab48899087cc647f0f791ed0c459adc53a39098fe882a26a0617bd71ad4d06c85a}{}I\+P6\+\_\+\+F\+H\+\_\+\+F\+\_\+\+A\+U\+T\+H\label{net_2ipv6_8h_ab48899087cc647f0f791ed0c459adc53a39098fe882a26a0617bd71ad4d06c85a}
}]\index{I\+P6\+\_\+\+F\+H\+\_\+\+F\+\_\+\+S\+K\+I\+P\+\_\+\+R\+H@{I\+P6\+\_\+\+F\+H\+\_\+\+F\+\_\+\+S\+K\+I\+P\+\_\+\+R\+H}!net/ipv6.\+h@{net/ipv6.\+h}}\index{net/ipv6.\+h@{net/ipv6.\+h}!I\+P6\+\_\+\+F\+H\+\_\+\+F\+\_\+\+S\+K\+I\+P\+\_\+\+R\+H@{I\+P6\+\_\+\+F\+H\+\_\+\+F\+\_\+\+S\+K\+I\+P\+\_\+\+R\+H}}\item[{\em 
\hypertarget{net_2ipv6_8h_ab48899087cc647f0f791ed0c459adc53ae061c21caac2cca8aed854ed6fb1fa61}{}I\+P6\+\_\+\+F\+H\+\_\+\+F\+\_\+\+S\+K\+I\+P\+\_\+\+R\+H\label{net_2ipv6_8h_ab48899087cc647f0f791ed0c459adc53ae061c21caac2cca8aed854ed6fb1fa61}
}]\end{description}
\end{Desc}

\begin{DoxyCode}
20      \{
21     \hyperlink{net_2ipv6_8h_ab48899087cc647f0f791ed0c459adc53a896e48b555d0207d316edb0043e46882}{IP6\_FH\_F\_FRAG}           = (1 << 0),
22     \hyperlink{net_2ipv6_8h_ab48899087cc647f0f791ed0c459adc53a39098fe882a26a0617bd71ad4d06c85a}{IP6\_FH\_F\_AUTH}           = (1 << 1),
23     \hyperlink{net_2ipv6_8h_ab48899087cc647f0f791ed0c459adc53ae061c21caac2cca8aed854ed6fb1fa61}{IP6\_FH\_F\_SKIP\_RH}        = (1 << 2),
24 \};
\end{DoxyCode}


\subsection{Function Documentation}
\hypertarget{net_2ipv6_8h_a532005f62f05cefdb81971e7c338d74d}{}\index{net/ipv6.\+h@{net/ipv6.\+h}!rpl\+\_\+ipv6\+\_\+find\+\_\+hdr@{rpl\+\_\+ipv6\+\_\+find\+\_\+hdr}}
\index{rpl\+\_\+ipv6\+\_\+find\+\_\+hdr@{rpl\+\_\+ipv6\+\_\+find\+\_\+hdr}!net/ipv6.\+h@{net/ipv6.\+h}}
\subsubsection[{rpl\+\_\+ipv6\+\_\+find\+\_\+hdr}]{\setlength{\rightskip}{0pt plus 5cm}int rpl\+\_\+ipv6\+\_\+find\+\_\+hdr (
\begin{DoxyParamCaption}
\item[{const struct sk\+\_\+buff $\ast$}]{skb, }
\item[{unsigned int $\ast$}]{offset, }
\item[{int}]{target, }
\item[{unsigned short $\ast$}]{fragoff, }
\item[{int $\ast$}]{fragflg}
\end{DoxyParamCaption}
)}\label{net_2ipv6_8h_a532005f62f05cefdb81971e7c338d74d}

\begin{DoxyCode}
80 \{
81     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} start = \hyperlink{skbuff_8h_aabe75b44039b11c1b7c6e2f246e7146e}{skb\_network\_offset}(skb) + \textcolor{keyword}{sizeof}(\textcolor{keyword}{struct }ipv6hdr);
82     u8 nexthdr = \hyperlink{linux_2ipv6_8h_ab31aa2f5ade9dadb3cede168a0761bb3}{ipv6\_hdr}(skb)->nexthdr;
83     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} len;
84     \textcolor{keywordtype}{bool} found;
85 
86     \textcolor{keywordflow}{if} (fragoff)
87         *fragoff = 0;
88 
89     \textcolor{keywordflow}{if} (*offset) \{
90         \textcolor{keyword}{struct }ipv6hdr \_ip6, *ip6;
91 
92         ip6 = skb\_header\_pointer(skb, *offset, \textcolor{keyword}{sizeof}(\_ip6), &\_ip6);
93         \textcolor{keywordflow}{if} (!ip6 || (ip6->version != 6)) \{
94             printk(KERN\_ERR \textcolor{stringliteral}{"IPv6 header not found\(\backslash\)n"});
95             \textcolor{keywordflow}{return} -EBADMSG;
96         \}
97         start = *offset + \textcolor{keyword}{sizeof}(\textcolor{keyword}{struct }ipv6hdr);
98         nexthdr = ip6->nexthdr;
99     \}
100     len = skb->len - start;
101 
102     \textcolor{keywordflow}{do} \{
103         \textcolor{keyword}{struct }ipv6\_opt\_hdr \_hdr, *hp;
104         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} hdrlen;
105         found = (nexthdr == \hyperlink{flow_8h_a5fb304013ae6aaeaee9d7fdcfd343292}{target});
106 
107         \textcolor{keywordflow}{if} ((!ipv6\_ext\_hdr(nexthdr)) || nexthdr == NEXTHDR\_NONE) \{
108             \textcolor{keywordflow}{if} (\hyperlink{flow_8h_a5fb304013ae6aaeaee9d7fdcfd343292}{target} < 0 || found)
109                 \textcolor{keywordflow}{break};
110             \textcolor{keywordflow}{return} -ENOENT;
111         \}
112 
113         hp = skb\_header\_pointer(skb, start, \textcolor{keyword}{sizeof}(\_hdr), &\_hdr);
114         \textcolor{keywordflow}{if} (hp == NULL)
115             \textcolor{keywordflow}{return} -EBADMSG;
116 
117         \textcolor{keywordflow}{if} (nexthdr == NEXTHDR\_ROUTING) \{
118             \textcolor{keyword}{struct }ipv6\_rt\_hdr \_rh, *rh;
119 
120             rh = skb\_header\_pointer(skb, start, \textcolor{keyword}{sizeof}(\_rh),
121                         &\_rh);
122             \textcolor{keywordflow}{if} (rh == NULL)
123                 \textcolor{keywordflow}{return} -EBADMSG;
124 
125             \textcolor{keywordflow}{if} (\hyperlink{flow_8h_af4f7a53f6b2df72c34ca881f2714ac91}{flags} && (*\hyperlink{flow_8h_af4f7a53f6b2df72c34ca881f2714ac91}{flags} & \hyperlink{net_2ipv6_8h_ab48899087cc647f0f791ed0c459adc53ae061c21caac2cca8aed854ed6fb1fa61}{IP6\_FH\_F\_SKIP\_RH}) &&
126                 rh->segments\_left == 0)
127                 found = \textcolor{keyword}{false};
128         \}
129 
130         \textcolor{keywordflow}{if} (nexthdr == NEXTHDR\_FRAGMENT) \{
131             \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{short} \_frag\_off;
132             \_\_be16 *fp;
133 
134             \textcolor{keywordflow}{if} (\hyperlink{flow_8h_af4f7a53f6b2df72c34ca881f2714ac91}{flags}) \textcolor{comment}{/* Indicate that this is a fragment */}
135                 *\hyperlink{flow_8h_af4f7a53f6b2df72c34ca881f2714ac91}{flags} |= \hyperlink{net_2ipv6_8h_ab48899087cc647f0f791ed0c459adc53a896e48b555d0207d316edb0043e46882}{IP6\_FH\_F\_FRAG};
136             fp = skb\_header\_pointer(skb,
137                         start+offsetof(\textcolor{keyword}{struct} frag\_hdr,
138                                    frag\_off),
139                         \textcolor{keyword}{sizeof}(\_frag\_off),
140                         &\_frag\_off);
141             \textcolor{keywordflow}{if} (fp == NULL)
142                 \textcolor{keywordflow}{return} -EBADMSG;
143 
144             \_frag\_off = ntohs(*fp) & ~0x7;
145             \textcolor{keywordflow}{if} (\_frag\_off) \{
146                 \textcolor{keywordflow}{if} (\hyperlink{flow_8h_a5fb304013ae6aaeaee9d7fdcfd343292}{target} < 0 &&
147                     ((!ipv6\_ext\_hdr(hp->nexthdr)) ||
148                      hp->nexthdr == NEXTHDR\_NONE)) \{
149                     \textcolor{keywordflow}{if} (fragoff)
150                         *fragoff = \_frag\_off;
151                     \textcolor{keywordflow}{return} hp->nexthdr;
152                 \}
153                 \textcolor{keywordflow}{return} -ENOENT;
154             \}
155             hdrlen = 8;
156         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (nexthdr == NEXTHDR\_AUTH) \{
157             \textcolor{keywordflow}{if} (\hyperlink{flow_8h_af4f7a53f6b2df72c34ca881f2714ac91}{flags} && (*\hyperlink{flow_8h_af4f7a53f6b2df72c34ca881f2714ac91}{flags} & \hyperlink{net_2ipv6_8h_ab48899087cc647f0f791ed0c459adc53a39098fe882a26a0617bd71ad4d06c85a}{IP6\_FH\_F\_AUTH}) && (
      \hyperlink{flow_8h_a5fb304013ae6aaeaee9d7fdcfd343292}{target} < 0))
158                 \textcolor{keywordflow}{break};
159             hdrlen = (hp->hdrlen + 2) << 2;
160         \} \textcolor{keywordflow}{else}
161             hdrlen = ipv6\_optlen(hp);
162 
163         \textcolor{keywordflow}{if} (!found) \{
164             nexthdr = hp->nexthdr;
165             len -= hdrlen;
166             start += hdrlen;
167         \}
168     \} \textcolor{keywordflow}{while} (!found);
169 
170     *offset = start;
171     \textcolor{keywordflow}{return} nexthdr;
172 \}
\end{DoxyCode}
